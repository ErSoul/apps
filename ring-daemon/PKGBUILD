
pkgname=ring-daemon
pkgver=2.3.0.1
_commit=fc613326db4f9a5115e132d25c07e8c448514c10
pkgrel=1
pkgdesc="Ring daemon"
license=('GPL3')
arch=('x86_64')
url="https://github.com/savoirfairelinux/ring-daemon"
depends=('alsa-lib' 'boost-libs' 'dbus-c++' 'expat' 'ffmpeg' 'gsm' 'gnutls' 'jack' 'libsamplerate'
         'libsndfile' 'libsrtp' 'libupnp' 'pulseaudio' 'opendht' 'openssl' 'opus' 'pcre'
         'speex' 'speexdsp' 'systemd' 'yaml-cpp' 'yasm' 'jsoncpp') 
makedepends=('boost' 'git')
source=("https://github.com/savoirfairelinux/ring-daemon/archive/${_commit}.zip")
md5sums=('311cec7c4c8a7c4d6ec06aef54a846dd')

build() {
  mkdir -p ${pkgname}-${_commit}/contrib/native
  cd ${pkgname}-${_commit}/contrib/native
  
  ../bootstrap
  make -j1 .pjproject

  cd ../..
  
  ./autogen.sh
  ./configure --prefix=/usr \
    --sbindir=/usr/bin \
    --libexecdir=/usr/bin \
    --sysconfdir=/etc
  make
}

package() {
  cd ${pkgname}-${_commit}
  
  make DESTDIR=${pkgdir} install
}
