
# build version at https://dolphin-emu.org/download/
pkgname=dolphin-emu
pkgver=5.0.7369
pkgrel=1
_commit=082573bd6b4e8e9ce70a8839a83e0c5380b487b0
pkgdesc='GameCube, Wii and Triforce emulator'
arch=('x86_64')
url='http://dolphin-emu.org'
license=('GPL2')
depends=('bluez' 'ffmpeg' 'glew' 'libao' 'miniupnpc' 'openal' 'portaudio'
         'sdl2' 'soundtouch' 'qt5-base' 'pulseaudio' 'glu')
makedepends=('cmake' 'opencl-headers')
source=("https://github.com/dolphin-emu/dolphin/archive/082573bd6b4e8e9ce70a8839a83e0c5380b487b0.zip")
#source=("https://github.com/dolphin-emu/dolphin/archive/${pkgver}.tar.gz")
md5sums=('a81a3b46aa72a30408a430873b262d32')
         
build() {
  cd dolphin-${_commit}

  mkdir build 
  cd build
  cmake .. -DCMAKE_INSTALL_PREFIX=/usr \
           -DCMAKE_CXX_FLAGS='-fno-inline-functions -fpermissive' \
           -DENABLE_LTO=ON \
           -DENABLE_QT2=ON \
           -DENABLE_WX=OFF 
  make
}

package() {
  cd dolphin-${_commit}/build

  make DESTDIR=${pkgdir} install
  
  #install -m 755 Binaries/dolphin-emu-qt2 ${pkgdir}/usr/bin/
  #sed -i -e 's|Exec=dolphin-emu|Exec=dolphin-emu-qt|' ${pkgdir}/usr/share/applications/dolphin-emu.desktop
}


