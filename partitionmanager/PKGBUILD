
pkgname=partitionmanager
pkgver=1362680
pkgrel=5
pkgdesc="Easily manage disks, partitions and file systems on your KDE Desktop"
arch=('x86_64')
url="https://sourceforge.net/projects/partitionman"
license=('GPL2')
depends=('kde-runtime' 'parted' 'libatasmart')
makedepends=('cmake' 'automoc4' 'pkgconfig' 'git')
optdepends=('e2fsprogs: ext2/3/4 support'
	    'xfsprogs: XFS support'
	    'jfsutils: JFS support'
	    'reiserfsprogs: Reiser support'
	    'ntfsprogs: NTFS support'
	    'dosfstools: FAT32 support')
groups=('system')
install=partitionmanager.install	
source=("git://anongit.kde.org/partitionmanager")
md5sums=('SKIP')

build() {
  cd "${srcdir}"
  # filsystem code from src/fs/filesystem.h, set as default
  sed -i -e 's/FileSystem::Ext3/FileSystem::Xfs/' ${srcdir}/$pkgname/src/config.kcfg
  
  mkdir build
  cd build
  #patch -p1 < ${srcdir}/tribe.patch
  #patch -p1 < ${srcdir}/disable-gpt.patch

  cmake ../$pkgname \
        -DCMAKE_INSTALL_PREFIX=/usr \
        -DCMAKE_BUILD_TYPE=RelWithDebInfo \
        -DENABLE_UDISKS2=off

  make 
}

package() {
  cd build
  
  make DESTDIR="${pkgdir}" install 
}

