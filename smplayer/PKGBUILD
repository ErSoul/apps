
pkgname=smplayer
pkgver=14.9.0.6994
_pkgver=14.9.0
_rev=r6994
pkgrel=1
pkgdesc="A complete front-end for MPlayer and MPV"
arch=('x86_64')
url="http://smplayer.sourceforge.net/"
license=('GPL')
depends=('qt5-multimedia' 'qt5-script' 'mplayer' 'mpv')
makedepends=('qt5-tools' 'subversion')
groups=('multimedia')
source=("http://sourceforge.net/projects/smplayer/files/Unstable/releases/smplayer-${pkgver}.tar.bz2"
#source=("smplayer::svn+https://subversion.assembla.com/svn/smplayer/smplayer/trunk/"
        'icons.tar.xz'
        'default-theme.zip'
        'qt5.5.diff')
md5sums=('666a589b1fc3480a29e87f0ee7efd511'
         'a65b679cb82e21f8f67e703209654e8f'
         '5f7ef1845f64d0e174a23181e83e29a5'
         '015a4a2cf0754f8ed25f230989feea1d')

build() {
  cd "${srcdir}/${pkgname}-${pkgver}"
  rm -r "${srcdir}/${pkgname}-${pkgver}/icons"
  rm -r "${srcdir}/${pkgname}-${pkgver}/src/default-theme"
  mv -iv "${srcdir}/icons/" "${srcdir}/${pkgname}-${pkgver}/"
  mv -iv "${srcdir}/default-theme/" "${srcdir}/${pkgname}-${pkgver}/src/"
  
  patch -p1 -i "${srcdir}/qt5.5.diff"
  
  make PREFIX=/usr QMAKE=/usr/lib/qt5/bin/qmake LRELEASE=/usr/lib/qt5/bin/lrelease
  
  DOC_PATH="\\\"/usr/share/doc/smplayer\\\"" QMAKE_OPTS=DEFINES+=NO_DEBUG_ON_CONSOLE
}

package() {
  cd "${srcdir}/${pkgname}-${pkgver}"
  
  make DOC_PATH=/usr/share/doc/smplayer DESTDIR="$pkgdir" PREFIX="/usr" install
}
