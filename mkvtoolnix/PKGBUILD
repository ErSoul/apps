
pkgname=mkvtoolnix
pkgver=9.2.0
_commit=3f92246ee9fe3ff8ce8ae1e421d725763952ff20
pkgrel=2
pkgdesc="Set of tools to create, edit and inspect Matroska files."
arch=('x86_64')
license=('GPL')
url="http://www.bunkus.org/videotools/mkvtoolnix/index.html"
depends=('flac' 'libmatroska' 'libogg' 'libvorbis' 'qt5-declarative' 'xdg-utils' 'libebml' 'zlib' 'boost-libs')
optdepends=('flac: for FLAC support (Free Lossless Audio Codec)'
            'lzo2: for additional compression capabilities'
            'bzip2: for additional compression capabilities'
            'file: for automatic content type detection'
            'curl: for online update checks')
makedepends=('gcc' 'boost' 'ruby') # 'clang')
groups=('multimedia')
source=("http://www.bunkus.org/videotools/mkvtoolnix/sources/$pkgname-$pkgver.tar.xz"
#source=("https://github.com/mbunkus/mkvtoolnix/archive/${_commit}.zip"
        "https://github.com/mbunkus/mkvtoolnix/commit/684f7c7c7b6a2e92f3befea665bcd3c0636f2c21.diff"
        'qt.57.diff')
md5sums=('a24b7635100cff6bc9ab0021068466c0'
         '28cbad1bc474e85899b70d36c4d01026'
         '803e8a988863f0ddc21a249df5f1e222')

build() {
  cd ${pkgname}-${pkgver}
  # fix for Qt 5.7 compile flags, c++11 needed
  #patch -p1 -i $srcdir/684f7c7c7b6a2e92f3befea665bcd3c0636f2c21.diff
  patch -p1 -i $srcdir/qt.57.diff
  CXXFLAGS="-std=c++11"
  
  #export CC=clang
  #export CXX=clang++
  
  #./autogen.sh
  ./configure --prefix=/usr --with-boost-libdir=/usr/lib
  rake
}

package () {
  cd ${pkgname}-${pkgver}
  
  rake DESTDIR=${pkgdir} install
}
