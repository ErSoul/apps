
pkgname=darktable
pkgver=1.6.2
_pkgver=1.6.2
pkgrel=1
pkgdesc="Open source photography workflow application and RAW developer"
arch=('x86_64')
url="http://darktable.sf.net/"
license=('GPL3')
depends=('exiv2' 'intltool' 'lcms2' 'lensfun' 'libglade' 'dbus-glib' 'curl' 'libgnome-keyring'
         'libgphoto2' 'openexr' 'sqlite' 'libxslt' 'libsoup' 'json-glib' 'flickcurl' 'librsvg'
         'colord' 'graphicsmagick' 'sdl' 'libwebp' 'openjpeg' 'gtk-engines')
makedepends=('cmake')
install=darktable.install
options=('!libtool')
source=("https://github.com/darktable-org/darktable/releases/download/release-$pkgver/darktable-$pkgver.tar.xz")
md5sums=('0f29413f877ed2dc85c31f4fd3eab6d1')

build() {
  cd "$srcdir/$pkgname-$pkgver"
  mkdir -p build
  
  cd build
  CXXFLAGS+=" -fpermissive"
  cmake \
      -DCMAKE_INSTALL_PREFIX=/usr \
      -DCMAKE_BUILD_TYPE=Release \
      -DBINARY_PACKAGE_BUILD=1 \
      -DBUILD_USERMANUAL=False \
      -DDONT_USE_INTERNAL_LUA=Off \
      ..
  make
}

package() {
  cd "$srcdir/$pkgname-$pkgver/build"
  
  make DESTDIR="$pkgdir" install
}
