# Maintainer: abveritas@chakra-project.org

pkgname=qupzilla-wayland
pkgver=20130323
pkgrel=2
pkgdesc="A fast open source browser based on WebKit core, written in Qt Framework, wayland port"
arch=('x86_64')
url="http://www.qupzilla.com/"
screenshot="http://www.qupzilla.com/screens/kde.png"
license=('GPL')
depends=('qt5' 'mesa-wayland' 'qt5-qtwayland-git')
makedepends=('git')
provides=('qupzilla')
conflicts=('qupzilla')

_gitroot="https://github.com/QupZilla/qupzilla.git"
_gitname="qupzilla"

build() {
    cd $srcdir

      msg "Connecting to github.com GIT server...."
  if [ -d ${srcdir}/$_gitname ] ; then
      cd $_gitname && git pull origin
      msg "The local files are updated."
  else
      git clone $_gitroot
  fi
      msg "GIT checkout done or server timeout"

      msg "Starting make..."

  if [ -d ${srcdir}/${_gitname}-build ]; then
      rm -rf ${srcdir}/${_gitname}-build
  fi
    cp -r ${srcdir}/$_gitname ${srcdir}/${_gitname}-build
    cd ${srcdir}/${_gitname}-build

    export USE_WEBGL="true"
    export NO_X11="true"
   
   /usr/lib/qt5/bin/qmake 
    make clean
    make
}

package() {
    cd ${srcdir}/${_gitname}-build
   
    make INSTALL_ROOT="$pkgdir/" install
}
