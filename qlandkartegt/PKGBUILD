
pkgname=qlandkartegt
_pkgname=qlandkartegt-code-4016-QLandkarteGT-trunk
pkgver=1.8.1
pkgrel=4
pkgdesc="Use your GPS with Linux"
arch=('x86_64')
url="http://www.qlandkarte.org"
license=('GPL')
depends=('gdal' 'gpsd' 'libdmtx' 'libexif' 'libmariadbclient' 'mesa' 'postgresql-libs'
         'shared-mime-info' 'unixodbc' 'glu' 'qt5-webkit' 'proj' 'qt5-script')
makedepends=('cmake' 'extra-cmake-modules' 'qt5-tools')
groups=('utils')
#source=("http://downloads.sourceforge.net/qlandkartegt/$pkgname-$pkgver.tar.gz"
source=("http://sourceforge.net/code-snapshots/svn/q/ql/qlandkartegt/code/${_pkgname}.zip"
        'qlandkartegt-mimetypes.xml')
md5sums=('35cdc97a7dd7f91932a58ff68c82af89'
         'e4808690a9b5381880c573abd81cffdd')

#prepare() {
  #cd $pkgname-$pkgver
  
  #patch -p1 -i $srcdir/qt5.patch
  #sed -i 's|toAscii|toLatin1|g' $srcdir/$pkgname-$pkgver/src/CDlgEditWpt.cpp
  #sed -i 's|toAscii|toLatin1|g' $srcdir/$pkgname-$pkgver/src/CRouteToolWidget.cpp
#}

build() {
  mkdir build
  cd build
 
  cmake ../${_pkgname} \
      -DCMAKE_INSTALL_PREFIX=/usr \
      -DCMAKE_BUILD_TYPE=Release \
      -DQK_QT5_PORT=ON \
      -DQT_QMAKE_EXECUTABLE=/usr/lib/qt5/bin/qmake 
  make
}

package(){
  cd build
  make DESTDIR=${pkgdir} install

  install -D -m644 ${srcdir}/$pkgname-mimetypes.xml \
    ${pkgdir}/usr/share/mime/packages/$pkgname-mimetypes.xml
}
