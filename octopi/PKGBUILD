
pkgname=octopi
pkgver=0.1.7.2
pkgrel=1
_commit=8832f92
pkgdesc="This is Octopi, a powerful Pacman frontend using Qt libs"
url="https://octopiproject.wordpress.com/"
arch=('x86_64')
license=('GPL3')
depends=('qt' 'pacman')
makedepends=('automoc4' 'cmake')
groups=('system') 
source=("https://github.com/aarnt/octopi/tarball/master/octopi-${pkgver}.tar.gz"
        'octopi.desktop'
        'help_en_US.diff'
        'main.diff'
        'mainwindow_news.diff'
        'strconstants.h.diff'
        'unixcommand.diff'
        'unixcommand.h.diff')
md5sums=('06b30678a1c53ab9fbecc403546d7d32'
         '2d9c64cd6402be69d2ee9fde5acc439e'
         '6d7ada95b736298b87a7addd32022c4d'
         '6e499a1f231a3714826ba9184aa8a460'
         '61f52d439eb19a3270344eb3f34d9fda'
         '5724e8d472795a2b1809c8b3050bbb06'
         '41f67a601370609edf5297459c0a5234'
         'ae689135a13024cf7e274e300adaa4cd')

build() {
   cd "${srcdir}/aarnt-octopi-${_commit}/"

   patch -p0 -i ${srcdir}/help_en_US.diff
   patch -p0 -i ${srcdir}/main.diff
   patch -p0 -i ${srcdir}/mainwindow_news.diff
   patch -p0 -i ${srcdir}/strconstants.h.diff
   patch -p0 -i ${srcdir}/unixcommand.diff
   patch -p0 -i ${srcdir}/unixcommand.h.diff
   
   qmake octopi.pro
   make
}

package() {
   cd "${srcdir}/aarnt-octopi-${_commit}/"
   
   mkdir -p ${pkgdir}/usr/share/icons
   install -m 644 -p resources/images/octopi_yellow.png ${pkgdir}/usr/share/icons/octopi.png
   
   mkdir -p ${pkgdir}/usr/bin
   cp bin/octopi ${pkgdir}/usr/bin
   
   mkdir -p ${pkgdir}/usr/share/applications
   install -m644 -p ${srcdir}/octopi.desktop ${pkgdir}/usr/share/applications
}