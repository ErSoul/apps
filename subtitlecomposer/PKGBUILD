
pkgname=subtitlecomposer
pkgver=0.5.7.1
_commit=1fabfa245763ecdabdf5e4b9cb13e92723eee1f7
pkgrel=1
pkgdesc="Open source text-based subtitle editor that supports basic and more advanced operations "
arch=('x86_64')
url="https://github.com/maxrd2/subtitlecomposer"
license=('GPL')
depends=('kauth' 'kconfig' 'kconfigwidgets' 'kcoreaddons' 'ki18n' 'kio' 'kxmlgui' 'sonnet'
         'kross' 'kcodecs' 'ktextwidgets' 'kwidgetsaddons' 'khtml' 
         'gettext' 'mplayer' 'mpv' 'icu')
makedepends=('extra-cmake-modules')
#source=("https://github.com/maxrd2/${pkgname}/archive/v${pkgver}.tar.gz")
source=("https://github.com/maxrd2/subtitlecomposer/archive/${_commit}.zip")
md5sums=('ba0399cf0b2bcf3dfacf7436b1bc63cd')

prepare() {
  cd $pkgname-${_commit}
  #patch -p1 -i $srcdir/qt5.5.diff
  sed -i -e 's|KF5::SonnetUi|KF5::SonnetUi KF5::KHtml|' src/common/CMakeLists.txt
  sed -i -e 's|I18n KIO XmlGui|I18n KIO KHtml XmlGui|' CMakeLists.txt
}

build() {
    cd ${pkgname}-${_commit}

    cmake -DCMAKE_INSTALL_PREFIX=/usr
    make
}

package() {
    cd ${pkgname}-${_commit}

    make DESTDIR=${pkgdir} install
}